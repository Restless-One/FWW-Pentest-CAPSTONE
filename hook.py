from app.utility.base_world import BaseWorld
from plugins.openvas.openvas_plugin import OpenVASPlugin

name = 'OpenVAS'
description = 'A plugin that integrates OpenVAS scanning'
address = '/plugin/openvas/gui'  # Ensure this attribute is included
access = BaseWorld.Access.RED

async def enable(services):
    # Create an instance of the OpenVASPlugin
    openvas_plugin = OpenVASPlugin()

    # Register the OpenVAS plugin as a service in Caldera
    services.get('app_svc').add_service('openvas', openvas_plugin)

    print("OpenVAS Plugin enabled")
