from flask_restful import Resource,reqparse
from tools import HydraTool

hydra_parser = reqparse.RequestParser()
hydra_parser.add_argument('target', required=True, help="Target IP or hostname is required")
hydra_parser.add_argument('username', required=True, help="Username is required")
hydra_parser.add_argument('password_list', required=True, help="Password list file is required")
hydra_parser.add_argument('service', required=True, help="Service type is required (e.g., ssh, ftp)")


class HydraEndpoint(Resource):
    def post(self):
        args = hydra_parser.parse_args()
        hydra_tool = HydraTool(
            target=args['target'],
            username=args['username'],
            password_list=args['password_list'],
            service=args['service']
        )

        result = hydra_tool.run()
        return result
class MainpageEndpoint(Resource):
    def get(self):
        return {'message': 'Hello, World!'}
def init_routes(api):
    api.add_resource(MainpageEndpoint, '/')
    api.add_resource(HydraEndpoint, '/run_hydra')